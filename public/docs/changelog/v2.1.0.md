# v2.1.0 - Manim Video Export & Streamlined Deployment

**Release Date**: 2025-10-07
**Status**: ✅ Complete

## 🎯 Overview

Major update adding **1-click video rendering** and **streamlined developer experience**. No more manual Manim CLI commands or juggling multiple terminals!

---

## ✨ New Features

### 🎬 Manim Video Export (Game Changer!)

**Before**: Download Python script → Run CLI manually → Wait → Find video
**After**: Click "Render Video" → Watch progress → Auto-download MP4

#### What's New

- **Backend Rendering Service**: Express server executes Manim CLI automatically
- **Progress Tracking**: Real-time updates during rendering (30-60s)
- **Auto-Download**: MP4 downloads when complete (no manual file hunt)
- **Graceful Fallback**: Downloads script if backend unavailable
- **Smart Detection**: Checks if backend is running before render

#### User Experience

```
1. Click "🎬 Manim" button
2. Configure quality/resolution/fps
3. Click "🎬 Render Video"
4. See progress: "Generating → Rendering → Complete!"
5. MP4 auto-downloads (3-15MB typical)
```

**Render Times**:
- Draft (480p): 10-20s
- Medium (720p): 30-60s ⭐ Recommended
- High (1080p): 60-120s
- 4K (2160p): 2-5min

---

### 🚀 Streamlined Deployment

**One command** to start frontend + backend:
```bash
npm run dev:full
```

**Benefits**:
- ✅ Single terminal (no more juggling)
- ✅ Color-coded output (cyan = frontend, magenta = backend)
- ✅ Ctrl+C kills both processes
- ✅ Professional DX like Next.js/Remix

**Uses**: `concurrently` package for parallel execution with nice formatting.

---

## 🔧 Technical Implementation

### Backend Service

**File**: `server/manim-service.js`

New `/api/manim/render-animation` endpoint:
- Accepts: `{ script, quality, resolution, fps }`
- Generates unique temp files
- Executes: `manim -qm --format mp4 script.py`
- Returns: Base64 video (<50MB) or file path

**Security**:
- Unique render IDs prevent collisions
- Cleanup after render (optional)
- CORS enabled for localhost:5000

### Frontend Service

**File**: `src/export/ManimVideoExporter.ts`

New `ManimVideoExporter` class:
- `checkAvailability()`: Health check
- `renderAnimation()`: Full render pipeline
- `downloadVideo()`: Browser download
- `cancel()`: Abort mid-render

**Progress Stages**:
1. Generating (10%)
2. Uploading (20%)
3. Rendering (30%)
4. Complete (100%)

### UI Updates

**File**: `src/ui/ManimExportDialog.tsx`

- **Primary Button**: "🎬 Render Video" (new!)
- **Secondary Button**: "📄 Download Script" (fallback)
- **Progress Bar**: Animated with gradient fill
- **Backend Status**: Detects if service running
- **Error Handling**: Shows clear messages

**CSS**: `src/ui/ExportDialog.css`
- `.render-progress`: Progress bar container
- `.progress-bar-fill`: Animated gradient
- `.progress-message`: Status text

---

## 📝 Configuration

### New Config Section

**File**: `public/config/manim-config.json`

```json
{
  "export": {
    "videoEndpoint": "http://localhost:5001",
    "progressUpdateIntervalMs": 1000,
    "timeoutSeconds": 300,
    "maxVideoSizeMB": 50
  }
}
```

### Package Scripts

**File**: `package.json`

```json
{
  "scripts": {
    "server": "cd server && npm run dev",
    "dev:full": "concurrently -n web,api -c cyan,magenta \"npm run dev\" \"npm run server\""
  }
}
```

---

## 📦 New Dependencies

### Production
- None (backend only)

### Development
- `concurrently@^9.2.1` - Run multiple npm scripts in parallel

### Backend (server/package.json)
- `express@^4.18.2` - HTTP server
- `cors@^2.8.5` - Cross-origin requests
- `nodemon@^3.0.1` - Auto-restart on file changes

---

## 🐛 Bug Fixes

### Fixed App.tsx Error
- **Issue**: `updateVariable` method didn't exist on `IndependentVariableManager`
- **Fix**: Changed to `updateDomain` (correct method name)
- **File**: `src/App.tsx:289`

---

## 📚 Documentation Updates

### New Documentation

- `MANIM_VIDEO_EXPORT_IMPLEMENTATION.md` - Complete implementation guide
- `STREAMLINED_DEPLOYMENT.md` - Deployment workflow guide
- `public/docs/user-guide/export.md` - Updated with video export instructions
- `public/docs/user-guide/getting-started.md` - Added `dev:full` command

### Updated Files

- `README.md` - New Quick Start with `dev:full`
- All root docs reference new video export feature

---

## 🎓 How to Use

### Prerequisites

```bash
pip install manim
manim --version  # Verify installation
```

### Start Application

**Recommended**:
```bash
npm run dev:full
```

**Or separately**:
```bash
npm run dev        # Terminal 1
npm run server     # Terminal 2
```

### Export Video

1. Create keyframes
2. Click "🎬 Manim" button
3. Click "🎬 Render Video"
4. Wait 30-60s
5. MP4 auto-downloads!

---

## ⚠️ Breaking Changes

None! Fully backward compatible.

- Script download still works
- Can still run frontend-only
- Manual Manim CLI still supported

---

## 🔮 Coming Next (v2.2+)

- WebSocket progress (frame-by-frame updates)
- Video preview before full render
- Render queue management
- Cloud rendering option
- GIF export support

---

## 📊 Performance

### Render Times (10s animation)

| Quality | Resolution | Time     | Size     |
|---------|-----------|----------|----------|
| Draft   | 480p      | 10-20s   | 1-2MB    |
| Medium  | 720p      | 30-60s   | 3-5MB    |
| High    | 1080p     | 60-120s  | 8-15MB   |
| 4K      | 2160p     | 2-5min   | 20-50MB  |

### Bundle Size Impact

- Frontend: No change (backend-only feature)
- `concurrently`: +2MB dev dependency
- Backend server: ~20MB (Express + deps)

---

## 🙏 Credits

Built with:
- Express.js - Backend server
- Manim Community - Video rendering
- `concurrently` - Process management

---

## 📖 References

- [Video Export Guide](../user-guide/export.md)
- [Getting Started](../user-guide/getting-started.md)
- [Implementation Details](../../../MANIM_VIDEO_EXPORT_IMPLEMENTATION.md)
- [Deployment Guide](../../../STREAMLINED_DEPLOYMENT.md)

---

**Upgrade Path**: Just `npm install` to get `concurrently`, then run `npm run dev:full`!
